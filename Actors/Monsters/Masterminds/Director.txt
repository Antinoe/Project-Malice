Class PM_Director : PMUnaffMonsterBase
{
	Default
	{
		//$Category "PM_Monsters/Masterminds"
		//$Title "Director"
		Health 3000;
		Radius 128;
		Height 100;
		Mass 2000;
		Speed 12;
		PainChance 40;
		Monster;
		+DONTHARMSPECIES
		+DONTHARMCLASS
		+NOFEAR
		+DONTRIP
		+BOSS
		+MISSILEMORE
		+FLOORCLIP
		+NORADIUSDMG
		+DONTMORPH
		+BOSSDEATH
		SeeSound "Director/Sight";
		AttackSound "Director/Attack";
		PainSound "Director/Pain";
		DeathSound "Director/Death";
		Obituary "%o felt the utter liquidification of the Director's arsenal.";
		Tag "Director";
		Species "Mastermind";
		+DONTHARMSPECIES
		+DONTHARMCLASS
		Scale 1.1;
		BloodType "PM_NormalTyrantBloodBase";
		TeleFogSourceType "PM_SmallDemonicTeleportFog";
		TeleFogDestType "PM_DemonicTeleportFog";
	}
	
	States
	{
	Spawn:
		DIRE A 10
		{
			A_StopSounds(129, 135);
			A_Look();
		}
		Loop;
	See:
		DIRE A 0 { A_StopSounds(129, 135); bNOPAIN = false; }
		DIRE A 10 A_Chase();
		DIRE A 0 A_StartSound("Director/Servo",CHAN_5,CHANF_OVERLAP);
		DIRE ABBCC 6 A_Chase();
		DIRE A 0 A_Quake(2, 4, 0, 412);
		DIRE A 0 A_StartSound("Director/Step",CHAN_5,CHANF_OVERLAP);
		DIRE D 10 A_Chase();
		DIRE D 0 A_StartSound("Director/Servo",CHAN_5,CHANF_OVERLAP);
		DIRE DEEFF 6 A_Chase();
		DIRE A 0 A_Quake(2, 4, 0, 412);
		DIRE A 0 A_StartSound("Director/Step",CHAN_5,CHANF_OVERLAP);
		Loop;
	Missile:
	GAU8:
		DIRE G 0 A_StartSound("Director/Screech",CHAN_VOICE);
		DIRE GGGGGGGGGGGGGGGGGGGGGG 1 A_FaceTarget();
		DIRE G 0 A_StartSound("Director/WindUp",50,CHAN_OVERLAP,1);
		DIRE GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG 1 Light("TyrantFire") A_FaceTarget();
		DIRE G 0 Light("TyrantFire")
		{
			pm_attackloop = random(200, 400);
			A_StartSound("Director/GunStart",130);
			A_StartSound("Director/WindLoop",134,CHANF_LOOPING,pitch:0.85);
			A_StartSound("Bulltubus/IreWindLoop1",131,CHANF_LOOPING,0.75,attenuation:.7,pitch:1.85);
			A_StartSound("Bulltubus/IreWindLoop2",132,CHANF_LOOPING,0.75,attenuation:.7,pitch:1.25);
			A_StartSound("Bulltubus/IreGun",133,CHANF_LOOPING,1,.5,pitch:1.25);
		}
		DIRE HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH 1 Light("TyrantFire")
		{
			A_FaceTarget(2, 2);
			A_Quake(random(1, 3), 10, 0, 1000);
			A_SpawnProjectile("PM_RevolverTracer",48,0,frandom(-2,2),CMF_AIMDIRECTION|CMF_OFFSETPITCH,pitch+frandom(-2,2));
		}
		DIRE G 0 Light("TyrantFire") A_StartSound("Director/GunLoop",134,CHANF_LOOPING);
		Goto GAULoop;
	GAULoop:
		DIRE H 1 Light("TyrantFire")
		{
			pm_attackloop--;
			A_FaceTarget(2, 2);
			A_Quake(random(1, 3), 10, 0, 1000);
			A_SpawnProjectile("PM_RevolverTracer",48,0,frandom(-2,2),CMF_AIMDIRECTION|CMF_OFFSETPITCH,pitch+frandom(-2,2));
			
			if (pm_attackloop <= 0) SetStateLabel("NoAmmo");
			if (target && (!CheckSight(target) || target.Health <= 0)) SetStateLabel("Cooldown");
		}
		Loop;
	Cooldown:
		TNT1 A 0 A_StartSound("Director/GunEnd",CHAN_Weapon);
		DIRE A 40 A_StopSounds(129, 135);
		TNT1 A 0 A_StartSound("PM/ArachnoCooldown",attenuation:.6,pitch:.6);
		DIRE GGGGGGGGGGGGGGGGGGGGGGGGGGGGG 1
		{
			A_SpawnParticleEx
			(
			"",
			TexMan.CheckForTexture("LENYA0"),
			style: STYLE_Add,
			flags: SPF_RELATIVE|SPF_FULLBRIGHT,
			lifetime: 2,
			size: 130.0,
			angle: 0,
			xoff: 10,
			yoff: 0,
			zoff: 50,
			velx: 0,
			vely: 0,
			velz: 0,
			accelx: 0,
			accely: 0,
			accelz: 0,
			startalphaf: 0.7,
			fadestepf: 0,
			sizestep: 0,
			startroll: 0,
			rollvel: 0,
			rollacc: 0
			);
			A_SpawnParticleEx
			(
			"8a8a8a",
			TexMan.CheckForTexture("GNSMK0"),
			style: STYLE_Normal,
			flags: SPF_RELATIVE|SPF_ROLL,
			lifetime: random(20,100),
			size: frandom(80,150),
			angle: 0,
			xoff: random(16,20),
			yoff: random(-5,5),
			zoff: 50,
			velx: frandom(-0.8,4),
			vely: frandom(-0.8,0.8),
			velz: frandom(-0.8,0.8),
			accelx: 0,
			accely: 0,
			accelz: 0,
			startalphaf: 0.3,
			fadestepf: -0.5,
			sizestep: 0.2,
			startroll: random(-180,180),
			rollvel: 0,
			rollacc: 0
			);
			A_SpawnParticleEx
			(
			"C8C8C8",
			TexMan.CheckForTexture("GNSMK0"),
			style: STYLE_Normal,
			flags: SPF_RELATIVE|SPF_ROLL,
			lifetime: random(80,160),
			size: 6,
			angle: 0,
			xoff: 10,
			yoff: random(-5,5),
			zoff: 50,
			velx: 0,
			vely: frandom(16,22),
			velz: frandom(-0.2,0.3),
			accelx: 0,
			accely: -0.4,
			accelz: 0,
			startalphaf: 0.5,
			fadestepf: -1,
			sizestep: 5,
			startroll: random(-180,180),
			rollvel: 0,
			rollacc: 0
			);
			A_SpawnParticleEx
			(
			"C8C8C8",
			TexMan.CheckForTexture("GNSMK0"),
			style: STYLE_Normal,
			flags: SPF_RELATIVE|SPF_ROLL,
			lifetime: random(80,160),
			size: 6,
			angle: 0,
			xoff: 10,
			yoff: random(-5,5),
			zoff: 50,
			velx: 0,
			vely: frandom(-16,-22),
			velz: frandom(-0.2,0.3),
			accelx: 0,
			accely: 0.4,
			accelz: 0,
			startalphaf: 0.5,
			fadestepf: -1,
			sizestep: 5,
			startroll: random(-180,180),
			rollvel: 0,
			rollacc: 0
			);
		}
		Goto See;
	NoAmmo:
		TNT1 A 0 A_StartSound("Director/GunEnd",CHAN_Weapon);
		DIRE A 20 A_StopSounds(129, 135);
		TNT1 A 0 A_StartSound("PM/ArachnoCooldown",attenuation:.6,pitch:.6);
		TNT1 A 0 A_StartSound("PM/BigVentLoop",130,CHANF_LOOP);
		DIRE GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG 1
		{
			A_SpawnParticleEx
			(
			"",
			TexMan.CheckForTexture("LENYA0"),
			style: STYLE_Add,
			flags: SPF_RELATIVE|SPF_FULLBRIGHT,
			lifetime: 2,
			size: 130.0,
			angle: 0,
			xoff: 10,
			yoff: 0,
			zoff: 50,
			velx: 0,
			vely: 0,
			velz: 0,
			accelx: 0,
			accely: 0,
			accelz: 0,
			startalphaf: 0.7,
			fadestepf: 0,
			sizestep: 0,
			startroll: 0,
			rollvel: 0,
			rollacc: 0
			);
			A_SpawnParticleEx
			(
			"8a8a8a",
			TexMan.CheckForTexture("GNSMK0"),
			style: STYLE_Normal,
			flags: SPF_RELATIVE|SPF_ROLL,
			lifetime: random(20,100),
			size: frandom(80,150),
			angle: 0,
			xoff: random(16,20),
			yoff: random(-5,5),
			zoff: 50,
			velx: frandom(-0.8,4),
			vely: frandom(-0.8,0.8),
			velz: frandom(-0.8,0.8),
			accelx: 0,
			accely: 0,
			accelz: 0,
			startalphaf: 0.3,
			fadestepf: -0.5,
			sizestep: 0.2,
			startroll: random(-180,180),
			rollvel: 0,
			rollacc: 0
			);
			A_SpawnParticleEx
			(
			"C8C8C8",
			TexMan.CheckForTexture("GNSMK0"),
			style: STYLE_Normal,
			flags: SPF_RELATIVE|SPF_ROLL,
			lifetime: random(80,160),
			size: 6,
			angle: 0,
			xoff: 10,
			yoff: random(-5,5),
			zoff: 50,
			velx: 0,
			vely: frandom(16,22),
			velz: frandom(-0.2,0.3),
			accelx: 0,
			accely: -0.4,
			accelz: 0,
			startalphaf: 0.5,
			fadestepf: -1,
			sizestep: 5,
			startroll: random(-180,180),
			rollvel: 0,
			rollacc: 0
			);
			A_SpawnParticleEx
			(
			"C8C8C8",
			TexMan.CheckForTexture("GNSMK0"),
			style: STYLE_Normal,
			flags: SPF_RELATIVE|SPF_ROLL,
			lifetime: random(80,160),
			size: 6,
			angle: 0,
			xoff: 10,
			yoff: random(-5,5),
			zoff: 50,
			velx: 0,
			vely: frandom(-16,-22),
			velz: frandom(-0.2,0.3),
			accelx: 0,
			accely: 0.4,
			accelz: 0,
			startalphaf: 0.5,
			fadestepf: -1,
			sizestep: 5,
			startroll: random(-180,180),
			rollvel: 0,
			rollacc: 0
			);
		}
		Goto See;
	Pain:
		DIRE I 5 A_StopSounds(130, 134);
		DIRE I 5 A_Pain();
		Goto See;
	Death:
		DIRE I 1;
		DIRE I 1 A_StopSounds(130, 134);
		DIRE I 10 A_Scream();
		DIRE J 6 A_StartSound("Director/DeathServo", CHAN_BODY);
		DIRE K 7 Light("TyrantMExp");
		DIRE L 0 A_StartSound("Director/Fall", 55);
		DIRE LM 7 Light("TyrantMExp");
		TNT1 A 0 A_SpawnItemEx("OFireBallExplode",random(-10,10),0,random(-10,10));
		DIRE N 3 Light("AvatarFireball4") A_SpawnItemEx("OrangeEmbersSpawn",0,0,30);
		TNT1 AAAAAAA 0 A_SpawnItemEx("PM_GenericExplosionFlames",frandom(-40, 40),frandom(-40, 40),50,random(-3,3),random(-3,3),random(-2,3),0,SXF_NOCHECKPOSITION);
		TNT1 A 0
		{

			A_StartSound("ArachChassisExplode",CHAN_5,attenuation:.5,pitch:.5);
			A_Quake(6, 15, 0, 1000);
			A_Quake(3, 35, 0, 2000);
		}
		TNT1 A 0 A_SpawnItemEx("OrangeEmbersSpawn",0,0,25);
		TNT1 A 0 A_SpawnItemEx("OFireBallExplode",random(-10,10),0,30);
		TNT1 AAAAA 0 A_SpawnItemEx("PM_ArachnotronGenericExplosionFlames",0,0,35,random(-7,7),random(-7,7),random(0,7));
		TNT1 A 0 A_NoBlocking();
		TNT1 AAAAAA 0 A_SpawnItemEx("PM_NormalMeatChunkLauncher",0,0,random(10,30),0,0,0,0,SXF_NOCHECKPOSITION);
		TNT1 A 0 A_SpawnItemEx("PM_NormalBloodyCloudBig",0,0,20,0,0,0,0,SXF_NOCHECKPOSITION);
		TNT1 AAAAA 0 A_SpawnItemEx("PM_NormalBigMeatChunkLauncher",0,0,random(10,30),0,0,0,0,SXF_NOCHECKPOSITION);
		TNT1 FFFFFFFFFFFFFFFFFFFF 0 A_SpawnItemEX("PM_ArachExpGoreSplash", 0, 0, 32, random (4, 10), random(4,10), random (4, 15), random(0, 360));
		TNT1 A 0 A_SpawnItemEx("PM_ArachExpMist",0,0,20);
		TNT1 A 0 A_StartSound("BigExplosionDistant",5,CHANF_DEFAULT,0.7);
		TNT1 A 0 A_StartSound("ArachExpGore",CHAN_6);
		DIRE N 6 Light("TyrantExp");
		TNT1 AAAAAA 0 A_SpawnProjectile("SmokePuff",random(24,40),0,random(0,360),2,random(0,360));
		DIRE OPQRSSSSSSSSSSSSSSSS 6 Light("TyrantExp") A_SpawnItemEX("PM_ArachExpGoreSplash", 0, 0, 15, random (-3, 3), random(-3,3), random (4, 15));
		DIRE S -1 A_BossDeath();
		Stop;
	}
}